// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  
}
datasource db {
  provider = "postgresql"
  url = env("DATABASE_URL")

}

model Admin{
  id    String    @id
  username  String @unique
}
model Teacher{
      id    String    @id
  username String @unique
  name    String  
  surname   String
  email     String?  @unique  //question mark means email will not be required to be filled
  phoneno   String?   @unique
  address   String?
  img       String?
  age       Int
  sex       Gender 
  createdAt   DateTime  @default(now()) 
  subjects    Subject[]
  lessons     Lesson[]
  classes   Class[]
}
model Student{
  id    String    @id
  username String @unique
  name    String  
  surname   String
  email     String? @unique //question mark means email will not be required to be filled
  phoneno   String?  @unique
  address   String?
  img       String?
  age       Int
  sex       Gender 
  createdAt   DateTime  @default(now()) 
  parentId   String
  parent    Parent    @relation(fields: [parentId], references: [id])
  classid   Int
  class   Class   @relation(fields: [classid],references: [id])
  gradeid   Int
  grade   Grade   @relation(fields: [gradeid],references: [id])
  attendance    Attendance[]
  results     Result[]
}
model Parent{
  id    String    @id
  username String @unique
    name    String  
  surname   String
  email     String? @unique //question mark means email will not be required to be filled
  phoneno   String? @unique
  address   String?
  img       String?
  createdAt   DateTime    @default(now())
   students   Student[]

}
model Grade{
  id    Int  @id @default(autoincrement()) 
  level   Int    @unique
  students    Student[]
  classes     Class[]
}
model Lesson{
  id    Int   @id @default(autoincrement())
  name    String
  day   Day
  startTime   DateTime
  endTime     DateTime
  subjectid   Int
  subject   Subject   @relation(fields: [subjectid],references: [id])
  classid   Int
  class Class  @relation(fields: [classid],references: [id])
  teacherid   String
  teacher   Teacher   @relation(fields: [teacherid],references: [id])
  exams   Exam[]
  assignments   Assignment[]
  attendance    Attendance[]

}
model Exam{
  id    Int   @id @default(autoincrement())
  title   String  
  startTime   DateTime
  endTime     DateTime
  lessonid    Int
  lesson      Lesson    @relation(fields: [lessonid],references: [id])
  results     Result[]

}
model Assignment{
    id    Int   @id @default(autoincrement())
  title   String  
  deadline    DateTime
  lessonid    Int
  lesson      Lesson    @relation(fields: [lessonid],references: [id])
  results     Result[]
  

}
model Result{
  id    Int   @id @default(autoincrement())
  score   Int   
  examid    Int?
  exam    Exam?    @relation(fields: [examid],references: [id])
  assignmentid    Int?
  assignment    Assignment?    @relation(fields: [assignmentid],references: [id])
  studentid    String
  student    Student    @relation(fields: [studentid],references: [id])
  
}
model Subject{
  id    Int   @id @default(autoincrement())
  name    String    @unique
  teachers    Teacher[]
  lessons     Lesson[]
 
}
model Class{
  id      Int   @id @default(autoincrement())
  name    String    @unique
  capacity    Int
  lessons     Lesson[]
  superviserid    String
  superviser    Teacher   @relation(fields: [superviserid],references: [id])
  students    Student[]
  gradeid   Int
  grade     Grade   @relation(fields: [gradeid],references: [id])
  events    Event[]
  announcements   Announcement[]

}
model Attendance{
  id    Int   @id @default(autoincrement())
  date   DateTime
  present    Boolean
  studentId   String
  student   Student   @relation(fields: [studentId],references: [id])
  lessonId   Int
  lesson   Lesson   @relation(fields: [lessonId],references: [id])
  
}
model Event{
  id    Int   @id @default(autoincrement())
  title   String  
  description   String
  classId   Int  
  class   Class   @relation(fields: [classId],references: [id])
  startdate   DateTime
  enddate     DateTime

}
model Announcement{
    id    Int   @id @default(autoincrement())
  title   String  
  description   String
  classId   Int  
  class   Class   @relation(fields: [classId],references: [id])
  date    DateTime

}

enum Gender {
  MALE
  FEMALE
}

enum Day {
  MONDAY
  TUSEDAY
  WEDNESDAY
  THURSDAY
  FRIDAY
}